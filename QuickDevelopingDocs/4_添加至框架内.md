# ICTFE 开发快速上手文档 - 4 添加至框架内

## 添加Panel到Stack

以密码学为例, 在你构建好模块的UI部分并做完了事件处理之后, 你需要在`ui_Crypto.py`中定义当前工具的名称按钮, 与其他的按钮以网格形式排布在ScrollArea中. 如果这个按钮已经存在则跳过这一步.

然后在`ui_Crypto.py`的文件头部

```python
from Crypto.<模块文件夹>.<工具名称>Module import <工具名称>Panel
```

并在`ui_Crypto.py`的`ui_CryptoPanel`中`__init__`函数尾部

```python
        # xxx panel
        self.xxxPanel = xxxPanel()
        self.xxxPanel.setObjectName('xxxPanel')
        self.CryptoStack.addWidget(self.xxxPanel)
```

## 添加切换事件

然后在`Crypto.py`的`CryptoPanel`中`__init__`函数里面注册一下按钮点击切换到这个工具panel的事件:

```python
self.xxxButton.clicked.connect(self.ChangeCryptoxxx)
```

并编写这个事件.

```python
    def ChangeCryptoxxx(self):
        animation = Qt.QPropertyAnimation(self)
        animation.setTargetObject(self.CryptoChooser)
        animation.setPropertyName(b'pos')
        animation.setStartValue(QtCore.QPoint(
            self.CryptoChooserVBox[self.CryptoMode % 10], self.CryptoChooserHBox[self.CryptoMode // 10]))
        self.CryptoMode = 8
        self.CryptoStack.setCurrentWidget(self.xxxPanel)
        animation.setEndValue(QtCore.QPoint(
            self.CryptoChooserVBox[self.CryptoMode % 10], self.CryptoChooserHBox[self.CryptoMode // 10]))
        animation.setDuration(200)
        animation.start()
```

其中animation涉及的代码是进行标签切换动画(就是点一下就会移动到当前按钮下面的蓝色小条)

你需要计算一下你的按钮在整个工具按钮中从上往下数, 从左往右数处于第几个位置, 然后将这个位置-1, 并把CryptoMode设置为这个值. 一般情况下这个动画切换效果就可以正常工作了. 切换到你的panel只需要写一行代码, 也就是上面代码中那句`self.CryptoStack.setCurrentWidget(self.xxxPanel)`.

好的, 你所编写的模块可以使用了.

## 建议

如果本文叙述的不甚清晰, 你没有明白应当怎样去开发的话, 你可以去看`HTMLModule`, 以及`Crypto.py`和`ui_Crypto.py`是如何把`HTMLModule`集成进来的. 这个模块仅包含加密解密的按钮和文本框, 仅有两个事件, 一个是点击编码, 一个是点击解码, 应该十分容易理解.

你可以简单的从`ui_Crypto.py`中已经绘制了但是没有开发相关Module的那些button开始开发. 这样的话你就不用担心按钮没有地方画, 那个小蓝条动画位置不对的问题了.
